{% extends "base.html" %}

{% block content %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega/3.3.1/vega.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-lite/2.6.0/vega-lite.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-embed/3.20.0/vega-embed.min.js"></script>

    <div class="jumbotron">
        <div class="row">
            <div class="col-md-10 col-lg-6 col-sm-10">
                <h1 class="display-4">{{ stats['students'] }} Students</h1>
                <p class="lead">Pedagogy is a performance management tool for education professionals.</p>
                <ul>
                    <li>Conducted <span class="badge badge-dark">{{ stats['workshops'] }}</span> workshops</li>
                    <li>Clocked <span class="badge badge-dark">{{ stats['studenthours'] }}</span> hours of training</li>
                    <li>Consultative training for <span class="badge badge-dark">{{ stats['companies'] }}</span> 
                        <a href="https://www.youtube.com/channel/UCCix0G-RLoRTenSFEGrQILQ/videos" style="color:#b0e4ff">satisfied companies</a></li>
                    <li>A task force of <span class="badge badge-dark">{{ stats['instructors'] }}</span> emphathetic instructors</li>
                </ul>
                <!-- <div class="progress progress-dark mt-2">
                    <div class="progress-bar bg-dark" role="progressbar" aria-valuemin="0" aria-valuemax="100">{{ stats['progress'] }}%</div>
                </div> -->
            </div>
            <div class="col-md-10 col-lg-5 offset-lg-1 col-sm-10  mt-2">
                <div class="plot" id="vis_home_jumbo"></div>
            </div>
        </div>
        <hr class="mt-4 col-md-12">
        <small>This project is under active development. <br/> Feature request or report a bug <a href="https://github.com/onlyphantom/pedagogy/issues" style="color:#b0e4ff">on the project's repo.</a></small>         
    </div>
    <div class="row mt-2">
        <div class="col-md-12 col-sm-12 col-lg-12">
            <h4>Registered Instructors</h4>
            <br>
            {% for key, person in stats['registered'].iterrows() %}
                <img src="/static/img/instructors/{{ person['email'] }}.jpg" class="image", title="{{ person['name'] }}">
            {% endfor %}
        </div>
        
    </div>
    <br>
    <div class="row mt-2">
        <div class="col-md-3 col-sm-3 col-lg-3">
            <!-- manual offset -->
        </div>
        <div class="col-md-6 col-sm-6 col-lg-6">
            <h4>Leaderboard</h4>
            <table style="width:100%">
                <thead>
                    <th>
                        Name
                    </th>
                    <th>
                        Total Training Hours
                    </th>
                    <th>
                        Total Students Reached
                    </th>
                </thead>
                <tbody>
                    {% for person in stats['topten'].items %}
                    <tr>
                        <td>
                            {{ person.name }}
                        </td>
                        <td>
                            {{ person.total_hours }} Hours
                        </td>
                        <td>
                            {{ person.total_students }} Students
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-md-3 col-sm-3 col-lg-3">
            <!-- manual offset -->
        </div>
        <!-- <div class="col-md-8 col-sm-8 col-lg-8">
             heatmap plot goes here 
            <div class="plot" id="cal_heatmap"></div>
        </div> -->
        
    </div>
    <div>
        <div class="row mt-2">
            <div class="col-md-12 col-sm-12 col-lg-12">
                <!-- heatmap plot goes here -->
                <div class="plot" id="cal_heatmap"></div>
            </div>
        </div>
    </div>
    <br>
        
    <div class="row mt-2">
        <div class="col-md-10 col-lg-5 col-sm-10">
            <div class="jumbotron jumbo-mini">
                <!-- <h2>Hours by Category</h2>
                <div class="plot" id="vis_home_3"></div>
                <hr> -->
                <h2><i class="large material-icons">insert_chart_outlined</i> Personal Statistics</h2>
                <p>Registered as an instructor on Pedagogy? <br>
                    Log in and view detailed performance statistics:</p>
                    <ul>
                            <li>Personal Accomplishments</li>
                            <li>Accumulative Statistics</li>
                            <li>Key Milestones</li>
                            <li>Performance Indicators</li>
                            <li>Student Reviews</li>
                        </ul>
                <a class="btn btn-dark btn-sm" href="{{  url_for('accomplishment') }}" role="button">Accomplishment</a>
                <a class="btn btn-secondary btn-sm" href="{{  url_for('explorer') }}" role="button">Visual Explorer</a>
            </div>
        </div>
        <div class="col-md-10 col-lg-7 col-sm-10 mt-4">
            <div class="plot-area">
                <div class="plot" id="vis_home_2"></div>                
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function parse(url, div) {
            var opt = {
              mode: "vega-lite",
              renderer: "svg",
              actions: {export: false, source: false, editor: false}
            }; 
        //var spec = "https://raw.githubusercontent.com/vega/vega/master/docs/examples/bar-chart.vg.json";
    
            vegaEmbed(div, url, opt).then(function(result) {
              // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
            }).catch(console.error);
        }
        parse("/data/accum_global", "#vis_home_jumbo")
        parse("/data/calendar_heatmap", "#cal_heatmap")
        // parse("/data/accum_global", "#vis_home_2")
        // parse('/data/category_bars', '#vis_home_3')
    </script>

{% endblock %}